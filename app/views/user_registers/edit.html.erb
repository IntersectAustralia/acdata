<% title 'Edit My Details' %>

<div id="container_useredit">

  <%= nested_form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => {:method => :put}) do |f| %>
    <div id="container_useredit_forms">
      <%= render "shared/error_messages", :target => @user %>

      <div id="container_tabdata" class="clearfix">
        <div id="tabs" class="clearfix">

          <ul>
            <li><a href="#tabs-details">User Details</a></li>
            <li><a href="#tabs-sharing">Sharing</a></li>
            <li><a href="#tabs-automation">Automation</a></li>
          </ul>

          <div id="tabs-details" class="ui-tabs-hide">
            <%= render :partial => 'personal_details', :locals => {:f => f} %>
          </div>

          <div id="tabs-sharing" class="ui-tabs-hide">
            <%= render :partial => 'sharing_details', :locals => {:f => f} %>
          </div>

          <div id="tabs-automation" class="ui-tabs-hide">
            <%= render :partial => 'automation_details', :locals => {:f => f} %>
          </div>

        </div>
      </div>

    </div>

    <div id="container_useredit_footer">
      <%= f.submit "Update", :class => "blue right" %>
      <%= link_to '<span>Cancel</span>'.html_safe, root_path, :class => "button" %>
    </div>

  <% end %>
</div>

<script>
  $(document).ready(function () {
    $(function () {
      $("#tabs").tabs();
      var error_field = $('.field_with_errors').first();
      if (error_field != null) {
        $("#tabs").tabs('select', '#' + error_field.closest('.ui-tabs-panel').attr('id'));

      }
    });
  });

</script>